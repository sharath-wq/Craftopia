<!-- login-area start -->
<div class="register-area ptb-100">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12 col-12 col-lg-6 col-xl-6 ms-auto me-auto">
                <%- include('../../partials/flash-message.ejs') %>
                <div class="login">
                    <div class="login-form-container">
                        <div class="login-form">
                            <h2 class="text-center">My Details</h2>
                            <form
                                action="/user/profile/edit/<%= user?._id %>/?_method=PUT"
                                method="post"
                                enctype="multipart/form-data"
                            >
                                <!-- Profile Imgae -->
                                <div class="form-group text-center d-flex flex-column align-items-center">
                                    <img src="<%= user?.image ? user?.image : "/shop/img/team/user.png" %>" id="user-avatar"
                                    class="img-fluid rounded-circle" />
                                    <img
                                        src=""
                                        id="image-preview"
                                        class="img-fluid rounded-circle"
                                        style="display: none; width: 150px; height: 150px"
                                    />
                                    <input
                                        type="file"
                                        name="file"
                                        id="image-input"
                                        style="display: none"
                                        accept="image/*"
                                    />
                                    <button type="button" class="btn btn-dark mt-2 h-auto" id="change-avatar">
                                        <%= user?.image ? "Change Profile Picture" : "Add Profile Picture" %>
                                    </button>
                                </div>

                                <!-- Profile Image -->
                                <div class="form-group">
                                    <label for="first-name">First Name</label>
                                    <input
                                        type="text"
                                        class="form-control"
                                        name="firstName"
                                        id="first-name"
                                        placeholder="Enter First Name"
                                        value="<%= user?.firstName %>"
                                    />
                                </div>
                                <div class="form-group">
                                    <label for="last-name">Last Name</label>
                                    <input
                                        type="text"
                                        class="form-control"
                                        id="last-name"
                                        name="lastName"
                                        placeholder="Enter Last Name"
                                        value="<%= user?.lastName %>"
                                    />
                                </div>
                                <div class="form-group">
                                    <label for="street">Street</label>
                                    <input
                                        type="text"
                                        name="street"
                                        class="form-control"
                                        id="street"
                                        placeholder="Enter street"
                                        value="<%= user?.address[0]?.street %>"
                                    />
                                </div>
                                <div class="form-group">
                                    <label for="city">City</label>
                                    <input
                                        type="text"
                                        name="city"
                                        class="form-control"
                                        id="city"
                                        placeholder="Enter City"
                                        value="<%= user?.address[0]?.city %>"
                                    />
                                </div>
                                <div class="form-group">
                                    <label for="state">State</label>
                                    <input
                                        type="text"
                                        name="state"
                                        class="form-control"
                                        id="state"
                                        placeholder="Enter State"
                                        name="state"
                                        value="<%= user?.address[0]?.state %>"
                                    />
                                </div>
                                <div class="form-group">
                                    <label for="pincode">Pincode</label>
                                    <input
                                        type="text"
                                        name="pincode"
                                        class="form-control"
                                        id="pincode"
                                        placeholder="Enter Pincode"
                                        value="<%= user?.address[0]?.pincode %>"
                                    />
                                </div>
                                <div class="form-group">
                                    <div class="d-flex justify-content-between">
                                        <label for="mobile-number">Mobile Number</label>
                                        <% if (!user?.isMobileVerified) { %>
                                        <small class="text-danger"
                                            >Mobile not Verified click
                                            <a class="text-primary" href="/auth/send-otp">here</a> to verify</small
                                        >
                                        <% } %>
                                    </div>
                                    <input
                                        type="tel"
                                        name="mobile"
                                        class="form-control"
                                        value="<%= user?.mobile %>"
                                        id="mobile-number"
                                        placeholder="Enter Mobile Number"
                                    />
                                </div>
                                <div class="form-group">
                                    <div class="d-flex justify-content-between">
                                        <label for="email">Email</label>
                                        <% if (!user?.isEmailVerified) { %>
                                        <small class="text-danger"
                                            >Email not verified click
                                            <a class="text-primary" href="/user/profile/send-email-otp">here</a> to
                                            verify</small
                                        >
                                        <% } %>
                                    </div>
                                    <input
                                        type="email"
                                        class="form-control"
                                        id="email"
                                        name="email"
                                        placeholder="Enter Email"
                                        value="<%= user?.email %>"
                                        disabled
                                    />
                                </div>
                                <div class="button-box">
                                    <button type="submit" class="default-btn floatright">Save Change</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- login-area end -->

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const imageInput = document.getElementById("image-input");
        const imagePreview = document.getElementById("image-preview");
        const userAvatar = document.getElementById("user-avatar");

        // Add a click event listener to the "Change Profile Picture" button
        document.getElementById("change-avatar").addEventListener("click", function () {
            imageInput.click();
        });

        // Add an event listener for the file input change event
        imageInput.addEventListener("change", function () {
            const file = imageInput.files[0];

            if (file) {
                const reader = new FileReader();

                reader.onload = function (e) {
                    // Update the image preview with the selected image
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = "block";
                    userAvatar.style.display = "none"; // Hide the user avatar
                };

                reader.readAsDataURL(file);
            } else {
                // No file selected, hide the image preview and show the user avatar
                imagePreview.style.display = "none";
                userAvatar.style.display = "block";
            }
        });
    });
</script>
